<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Instalación y configuración de Passport | API con Laravel 8</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Esta guía le dará un ejemplo de como crear una API Rest con Laravel 8 y Passport">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/doc-api-laravel-8/assets/css/0.styles.6679b527.css" as="style"><link rel="preload" href="/doc-api-laravel-8/assets/js/app.92a88e4b.js" as="script"><link rel="preload" href="/doc-api-laravel-8/assets/js/2.a98ad724.js" as="script"><link rel="preload" href="/doc-api-laravel-8/assets/js/19.5c2c0e67.js" as="script"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/10.77c5e03c.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/11.6956ad80.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/12.dc897f28.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/13.6b87f9b9.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/14.ae2554be.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/15.6cfb7869.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/16.09557ec1.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/17.220ea0de.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/18.a85f60af.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/20.75179939.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/21.2a30d638.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/3.8bb05ca5.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/4.83fce895.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/5.33a173f2.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/6.7a505dc8.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/7.14b60190.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/8.822a3b13.js"><link rel="prefetch" href="/doc-api-laravel-8/assets/js/9.35501b87.js">
    <link rel="stylesheet" href="/doc-api-laravel-8/assets/css/0.styles.6679b527.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/doc-api-laravel-8/" class="home-link router-link-active"><!----> <span class="site-name">API con Laravel 8</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/doc-api-laravel-8/introduccion/" class="nav-link">
  Guía
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/doc-api-laravel-8/introduccion/" class="nav-link">
  Guía
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/doc-api-laravel-8/introduccion/" class="sidebar-link">Introducción</a></li><li><a href="/doc-api-laravel-8/instalacion/" class="sidebar-link">Instalación</a></li><li><a href="/doc-api-laravel-8/basedatos/" class="sidebar-link">Conexión y configuración Base de datos</a></li><li><a href="/doc-api-laravel-8/modelos/" class="sidebar-link">Modelos y Migraciones</a></li><li><a href="/doc-api-laravel-8/seeder-factory-faker/" class="sidebar-link">Seeders, Factories y Faker</a></li><li><a href="/doc-api-laravel-8/controlador-ruta/" class="sidebar-link">Controladores y Rutas</a></li><li><a href="/doc-api-laravel-8/passport/" aria-current="page" class="active sidebar-link">Instalación y configuración de Passport</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc-api-laravel-8/login/" class="sidebar-link">Login</a></li><li><a href="/doc-api-laravel-8/rutas-protegidas/" class="sidebar-link">Rutas protegidas</a></li><li><a href="/doc-api-laravel-8/cerrar-sesion/" class="sidebar-link">Cerrar sesión</a></li><li><a href="/doc-api-laravel-8/crud-generos/" class="sidebar-link">Registrar, Actualizar y Eliminar Géneros</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="instalacion-y-configuracion-de-passport"><a href="#instalacion-y-configuracion-de-passport" class="header-anchor">#</a> Instalación y configuración de Passport</h1> <p>Laravel <a href="https://laravel.com/docs/8.x/passport#introduction" target="_blank" rel="noopener noreferrer">Passport<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> proporciona una implementación completa del servidor OAuth2 para su aplicación Laravel en cuestión de minutos. Passport está construido sobre el servidor League OAuth2 mantenido por Andy Millington y Simon Hamp.</p> <h3 id="instalacion"><a href="#instalacion" class="header-anchor">#</a> Instalación</h3> <p>Para comenzar, instale Passport a través del administrador de paquetes Composer:</p> <div class="language- extra-class"><pre class="language-text"><code>composer require laravel/passport
</code></pre></div><p>El proveedor de servicios de Passport registra su propio directorio de migración de base de datos, por lo que debe migrar su base de datos después de instalar el paquete. Las migraciones de Passport crearán las tablas que su aplicación necesita para almacenar clientes OAuth2 y tokens de acceso:</p> <div class="language- extra-class"><pre class="language-text"><code>php artisan migrate
</code></pre></div><p>A continuación, debe ejecutar el <strong>passport:install</strong> comando Artisan. Este comando creará las claves de cifrado necesarias para generar tokens de acceso seguro. Además, el comando creará clientes de <strong>&quot;acceso personal&quot;</strong> y <strong>&quot;concesión de contraseña&quot;</strong> que se utilizarán para generar tokens de acceso:</p> <div class="language- extra-class"><pre class="language-text"><code>php artisan passport:install
</code></pre></div><p>Después de ejecutar el passport:install comando, agregue el <b>Laravel\Passport\HasApiTokens</b> rasgo a su <b>App\Models\UserModel</b>. Este rasgo proporcionará algunos métodos auxiliares a su modelo que le permitirán inspeccionar el token y los alcances del usuario autenticado:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Models</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Factories<span class="token punctuation">\</span>HasFactory</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notifiable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Passport<span class="token punctuation">\</span>HasApiTokens</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HasApiTokens</span><span class="token punctuation">,</span> HasFactory<span class="token punctuation">,</span> Notifiable<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>A continuación, debe llamar al <strong>Passport::routes</strong> método dentro del boot método de su <b>App\Providers\AuthServiceProvider</b>. Este método registrará las rutas necesarias para emitir tokens de acceso y revocar tokens de acceso, clientes y tokens de acceso personal:</p> <div class="language-php extra-class"><pre class="language-php"><code> <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">boot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">registerPolicies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name static-context">Passport</span><span class="token operator">::</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>No olvides importar la clase Passport en el <b>AuthServiceProvider</b>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Passport<span class="token punctuation">\</span>Passport</span><span class="token punctuation">;</span>
</code></pre></div><p>Finalmente, en el <b>config/auth.php</b> archivo de configuración de su aplicación , debe establecer la driveropción de la apiprotección de autenticación en passport. Esto le indicará a su aplicación que use Passport TokenGuardal autenticar solicitudes de API entrantes:</p> <div class="language- extra-class"><pre class="language-text"><code>'guards' =&gt; [
    'web' =&gt; [
        'driver' =&gt; 'session',
        'provider' =&gt; 'users',
    ],

    'api' =&gt; [
        'driver' =&gt; 'passport',
        'provider' =&gt; 'users',
    ],
],
</code></pre></div><p>¡Listo!, con esto ya tenemos Passport configurado y listo para generar Tokens de accesos.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/doc-api-laravel-8/controlador-ruta/" class="prev">
        Controladores y Rutas
      </a></span> <span class="next"><a href="/doc-api-laravel-8/login/">
        Login
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/doc-api-laravel-8/assets/js/app.92a88e4b.js" defer></script><script src="/doc-api-laravel-8/assets/js/2.a98ad724.js" defer></script><script src="/doc-api-laravel-8/assets/js/19.5c2c0e67.js" defer></script>
  </body>
</html>
